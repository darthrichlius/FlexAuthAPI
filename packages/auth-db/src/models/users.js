const{Schema}=require("mongoose"),userDbSchema=new Schema({fullname:{type:String,required:!0,minLength:3,maxLength:30},email:{type:String,required:!0,minLength:5,maxLength:255,unique:!0},password:{type:String,required:!0,minLength:8,maxLength:1024},roles:{type:[String],required:!0,validate:{validator:e=>Array.isArray(e)&&e.length>0,message:"Roles must contain at least one role."},enum:["admin","user"]}});userDbSchema.methods.getAccessTokenPayload=function(){return{email:this.email,roles:this.roles}},module.exports=userDbSchema;
