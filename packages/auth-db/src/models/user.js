const{Schema}=require("mongoose"),userDbSchema=new Schema({fullname:{type:String,required:!0,minLength:3,maxLength:30},email:{type:String,required:!0,minLength:5,maxLength:255,unique:!0},password:{type:String,required:!0,maxLength:1024},roles:{type:[String],required:!0,validate:{validator:e=>Array.isArray(e)&&e.length>0,message:"Roles must contain at least one role."},enum:["admin","user"]},mfaEnabled:{type:Boolean,default:!1},mfaVerified:{type:Boolean,default:!1},mfaSecret:{type:String},mfaBackupCodes:{type:[String],default:[]},mfaMethod:{type:String,enum:["totp",""]}});userDbSchema.methods.getAccessTokenPayload=function(){return{type:"accessToken",email:this.email,mfaEnabled:this.mfaEnabled,roles:this.roles}},userDbSchema.methods.getMfaAccessTokenPayload=function(){return{type:"mfaAccessToken",email:this.email}},module.exports=userDbSchema;
