const jwt=require("jsonwebtoken"),{getModels}=require("../globals/models"),_getModel=()=>getModels().User,defineAccessTokenPayload=e=>e.getAccessTokenPayload(),createAccessToken=(e,s)=>jwt.sign(e,s),verify=(e,s)=>{try{return jwt.verify(e,s)}catch{return}},generateDefaultAccessTokenPayload=(e,s)=>{const n=defineAccessTokenPayload(e);return createAccessToken(n,s)},getUserFromTokenPayload=async e=>{const s="email";return await _getModel().findOne({[s]:e[s]})};module.exports={defineAccessTokenPayload,createAccessToken,generateDefaultAccessTokenPayload,getUserFromTokenPayload,verify};
