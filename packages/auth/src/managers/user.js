const _=require("lodash"),{resourceManager}=require("@app/auth-db/services"),{getModels}=require("../globals/models"),_getModel=()=>getModels().User,exists=async e=>await _getModel().findOne(e),getById=async e=>await _getModel().findOne({_id:e}),update=async e=>{if(!e||!e._id)throw new Error("Invalid data: '_id' is required.");const s=await getById(e._id);if(!s)throw new Error("User not found.");return Object.assign(s,_.omit(e,["_id"])),await s.save()},register=async e=>{const s=_getModel(),r=e.roles||"user";return await new s({...e,roles:r}).save()},list=async(e={})=>{const s=_getModel();return await resourceManager.getItems(s,e)};module.exports={getById,exists,update,register,list};
