const router=require("express").Router(),{asyncError}=require("@app/lib/middlewares"),{authenticated,authorized}=require("../middlewares/auth"),{tokenManager}=require("../managers"),introspect=(t,r)=>{const{token:o}=t.body,e=tokenManager.verify(o,process.env.JWT_SECRET);return e?r.json({email:e.email,roles:e.roles,iat:e.iat}):r.status(400).send("Invalid token")};router.post("/introspect",[authenticated,authorized(["user"])],asyncError(introspect)),module.exports=router;
