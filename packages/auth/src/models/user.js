const Joi=require("joi"),userSchema={fullname:Joi.string().min(5).max(30),email:Joi.string().min(5).max(255).email(),password:Joi.string().min(8).max(30).regex(/^(?=.*\d)(?=.*[@\.\+$!%*?&])[A-Za-z\d@\.\+$!%*?&]{8,}$/).message("Password must be at least 8 characters long, contain at least one digit and one special character."),roles:Joi.array().items(Joi.string().valid("admin","user")).min(1),mfaEnabled:Joi.boolean(),mfaVerified:Joi.boolean(),mfaSecret:Joi.string(),mfaBackupCodes:Joi.array().items(Joi.string()).default([]),mfaMethod:Joi.string().valid("totp")};module.exports={userSchema,registerSchema:Joi.object({fullname:userSchema.fullname.required(),email:userSchema.email.required(),password:userSchema.password.required(),mfaEnabled:userSchema.mfaEnabled.required()}),mfaDisableSchema:Joi.object({mfaEnabled:userSchema.mfaEnabled.strict().valid(!1).required()}),mfaEnableSchema:Joi.object({mfaEnabled:userSchema.mfaEnabled.strict().required(),mfaMethod:userSchema.mfaMethod.required()}),mfaSetupSchema:Joi.object({mfaMethod:userSchema.mfaMethod.required()}),mfaToggleSchema:Joi.object({mfaEnabled:userSchema.mfaEnabled.strict(),mfaMethod:userSchema.mfaMethod}),mfaVerifySchema:Joi.object({mfaToken:Joi.string().min(6).max(8).required()}),mfaLoginSchema:Joi.object({mfaAccessToken:Joi.string().required(),mfaMethod:userSchema.mfaMethod.required(),mfaToken:Joi.string().min(6).max(8).required()})};
